import*as e from"@wordpress/interactivity";var t={d:(e,a)=>{for(var o in a)t.o(a,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:a[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const a=(o={getContext:()=>e.getContext,store:()=>e.store,useEffect:()=>e.useEffect},n={},t.d(n,o),n);var o,n;let r=e=>{const t=document.querySelector(".site-main h1")?.innerText||document.title;return l.pageLength,new DataTable(e,{pageLength:50,layout:{bottomStart:{info:{callback:function(e,t,a,o,n,r){return""}}},bottomEnd:{paging:{type:"simple_numbers"},info:{callback:function(e,t,a,o,n,r){return`${o} Records Found.`}}},topEnd:{search:{placeholder:"Enter keyword...",text:l.searchLabel||"Search"}},topStart:{buttons:[{extend:"csvHtml5",title:t,text:"Download Data"}]}},footerCallback:function(e,t,a,o,n){const r=this.api();void 0!==window.jQuery&&Array.from(r.columns().header()).forEach(((e,t)=>{if(e.getAttribute("data-summed")){const e=r.column(t).data().reduce((function(e,t){return Number(e)+Number(t)}),0),a=r.column(t),o=jQuery(a.footer());o&&o.html(e)}}))}})};const{state:l,actions:d,callbacks:c}=(0,a.store)("ttft/data-tables",{state:{isLoading:!1,pageLength:50},actions:{async renderTable(){const e=(0,a.getContext)();try{const{tableType:t,thinkTank:a,donor:o,donationYear:n,donorType:c,searchLabel:s,ajaxUrl:i,action:b,nonce:p}=l,u=new FormData;u.append("action",b),u.append("nonce",p),u.append("table_type",t),u.append("search_label",s||"Search"),u.append("donation_year",n||"all"),u.append("donor_type",c||"all"),u.append("think_tank",a),u.append("donor",o),l.isLoading=!0,e.isLoaded=!1;const y=await fetch(i,{method:"POST",body:u}),g=await y.text();if(!y.ok)throw new Error(`HTTP error! status: ${y.status}`);const m=JSON.parse(g);if(m.success){l.tableData=m.data,await d.destroyTableAsync();const e=document.getElementById(l.elementId);e&&(e.innerHTML=m.data,l.table&&(l.table=r(`#${l.tableId}`)))}}catch(e){}finally{l.isLoading=!1,e.isLoaded=!0}},initTable:()=>{l.table=r(`#${l.tableId}`)},destroyTable:()=>{l.table.clear().draw(),l.table.destroy()},destroyTableAsync:()=>new Promise((e=>{d.destroyTable(),e()})),updateContext:()=>{const e=(0,a.getContext)();e.tableType=l.tableType,e.donationYear=l.donationYear,e.donorType=l.donorType},generateSkeletonTable:e=>{let t="";for(let a=0;a<10;a++){t+='<tr class="row" width="100%">';for(let a=0;a<e;a++)t+='<td class="cell"><div class="loader"></div></td>';t+="</tr>"}return t}},callbacks:{loadAnimation:()=>{(0,a.useEffect)((()=>{const e=document.getElementById(l.elementId);if(l.isLoading&&e){const t=e.querySelectorAll("thead th").length,a=d.generateSkeletonTable(t),o=e.querySelector("tbody");o&&(o.innerHTML=a)}}),[l.isLoading])},initLog:()=>{},logTable:()=>{},logState:e=>{console.log("key: ",l.key)},logLoading:()=>{}}});