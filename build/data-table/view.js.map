{"version":3,"file":"data-table/view.js","mappings":"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","sources":["webpack://data-tables/external module \"@wordpress/interactivity\"","webpack://data-tables/webpack/bootstrap","webpack://data-tables/webpack/runtime/make namespace object","webpack://data-tables/./src/data-table/view.js"],"sourcesContent":["module.exports = __WEBPACK_EXTERNAL_MODULE__wordpress_interactivity_8e89b257__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","/**\n * WordPress dependencies\n */\nimport { store, getContext, getElement, useState, useEffect } from '@wordpress/interactivity';\n\nlet initTable = ( table ) => {\n\tconst title = document.querySelector( '.site-main h1' )?.innerText || document.title;\n    const pageLength = state.pageLength;\n\treturn new DataTable( table, {\n\t\tpageLength: 50,\n\t\tlayout: {\n            bottomStart: {\n                info: {\n                    callback: function ( s, start, end, max, total, result ) {\n                        return ``;\n                    }\n                },\n            },\n\t\t\tbottomEnd: {\n\t\t\t\tpaging: {\n\t\t\t\t\ttype: 'simple_numbers',\n\t\t\t\t},\n                info: {\n                    callback: function ( s, start, end, max, total, result ) {\n                        return `${max} Records Found.`;\n                    }\n                }\n\t\t\t},\n\t\t\ttopEnd: {\n\t\t\t\tsearch: {\n\t\t\t\t\tplaceholder: 'Enter keyword...',\n\t\t\t\t\ttext: state.searchLabel || 'Search',\n\t\t\t\t},\n\t\t\t},\n\t\t\ttopStart: {\n\t\t\t\tbuttons: [\n\t\t\t\t\t{\n\t\t\t\t\t\textend: 'csvHtml5',\n\t\t\t\t\t\ttitle: title,\n\t\t\t\t\t\ttext: 'Download Data',\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t},\n\n        footerCallback: function( row, data, start, end, display ) {\n            const api = this.api();\n\n            if ( 'undefined' == typeof window.jQuery ) {\n                return;\n            }\n\n            Array.from( api.columns().header() ).forEach( ( header, index ) => {\n                if ( header.getAttribute( 'data-summed' ) ) {\n\n                    const total = api.column( index ).data().reduce( function( a, b ) {;\n                        return Number( a ) + Number( b );\n                    }, 0 );\n\n                    const $column = api.column( index );\n                    const $footer = jQuery( $column.footer() );\n\n                    if ( $footer ) {\n                        $footer.html( total );\n                    }\n\n                }\n            });\n        }\n\t} );\n}\n\nconst { state, actions, callbacks } = store( 'ttft/data-tables', {\n\tstate: {\n\t\tisLoading: false,\n        pageLength: 50,\n\t},\n    actions: {\n        async renderTable() {\n            const context = getContext();\n\n            try {\n                const { tableType, thinkTank, donor, donationYear, donorType, searchLabel, ajaxUrl, action, nonce } = state;\n\n                const formData = new FormData();\n                formData.append( 'action', action );\n                formData.append( 'nonce', nonce );\n                formData.append( 'table_type', tableType );\n                formData.append( 'search_label', searchLabel || 'Search' );\n                formData.append( 'donation_year', donationYear || 'all' );\n                formData.append( 'donor_type', donorType || 'all' );\n                formData.append( 'think_tank', thinkTank );\n                formData.append( 'donor', donor );\n\n                // console.log( `formData: `, formData );\n\n\t\t\t\tstate.isLoading = true;\n                context.isLoaded = false;\n\n                const response = await fetch( ajaxUrl, {\n                    method: 'POST',\n                    body: formData,\n                });\n\n                const responseText = await response.text();\n\n                // console.log( `responseText: `, responseText );\n\n\t\t\t\tif ( ! response.ok ) {\n                    throw new Error( `HTTP error! status: ${response.status}` );\n                }\n\n                const jsonResponse = JSON.parse( responseText );\n\n                if ( jsonResponse.success ) {\n                    state.tableData = jsonResponse.data;\n\n                    // debugger;\n\n                    await actions.destroyTableAsync();\n\n                    const container = document.getElementById( state.elementId );\n\n                    if ( container ) {\n                        container.innerHTML = jsonResponse.data;\n\n                        if ( state.table ) {\n                            state.table = initTable( `#${state.tableId}` );\n                        }\n                    }\n\n                } else {\n                    // console.error( `Error fetching table data:`, jsonResponse.data );\n                }\n            } catch ( event ) {\n                // console.error( `catch( event ) renderTable:`, event );\n            } finally {\n                state.isLoading = false;\n                context.isLoaded = true;\n            }\n        },\n\t\tinitTable: () => {\n\t\t\tstate.table = initTable( `#${state.tableId}`, state );\n\t\t},\n\t\tdestroyTable: () => {\n\t\t\tstate.table.clear().draw();\n\t\t\tstate.table.destroy();\n\t\t},\n        destroyTableAsync: () => {\n            return new Promise( ( resolve ) => {\n                actions.destroyTable();\n                resolve();\n            });\n        },\n        updateContext: () => {\n            const context = getContext();\n            context.tableType = state.tableType;\n            context.donationYear = state.donationYear;\n            context.donorType = state.donorType;\n        },\n        generateSkeletonTable: ( columns ) => {\n            let rows = '';\n            const max = 10;\n            for ( let rowIndex = 0; rowIndex < max; rowIndex++ ) {\n                rows += '<tr class=\"row\" width=\"100%\">';\n                for ( let colIndex = 0; colIndex < columns; colIndex++ ) {\n                    rows += '<td class=\"cell\"><div class=\"loader\"></div></td>';\n                }\n                rows += '</tr>';\n            }\n            return rows;\n        }\n    },\n    callbacks: {\n        loadAnimation: () => {\n            useEffect( () => { \n                const container = document.getElementById( state.elementId );\n                if ( state.isLoading && container ) {\n                    const columns = container.querySelectorAll( 'thead th' ).length;\n                    const skeletonTable = actions.generateSkeletonTable( columns );\n                    container.querySelector( 'tbody' ).innerHTML = skeletonTable;\n                } }, [ state.isLoading ] );\n        },\n        initLog: () => {\n            // console.log( `Initial State: `, JSON.stringify( state, undefined, 2 )  );\n            // const { tableType, donationYear, donorType, isLoaded } = getContext();\n            // console.log( `Initial Context: ${tableType}, isLoaded: ${isLoaded}, ${donationYear}, ${donorType}` );\n        },\n        logTable: () => {\n            // const { tableType, thinkTank, donor, donationYear, donorType, isLoading } = state;\n            // console.log( `State: `, tableType, thinkTank, donor, donationYear, donorType, isLoading );\n        },\n        logState: ( key ) => {\n            console.log( `key: `, state.key );\n        },\n\t\tlogLoading: () => {\n\t\t\t// console.log( `IS LOADING: `, state.isLoading );\n\t\t}\n    },\n});\n"],"names":["store","getContext","getElement","useState","useEffect","initTable","table","title","document","querySelector","innerText","pageLength","state","DataTable","layout","bottomStart","info","callback","s","start","end","max","total","result","bottomEnd","paging","type","topEnd","search","placeholder","text","searchLabel","topStart","buttons","extend","footerCallback","row","data","display","api","window","jQuery","Array","from","columns","header","forEach","index","getAttribute","column","reduce","a","b","Number","$column","$footer","footer","html","actions","callbacks","isLoading","renderTable","context","tableType","thinkTank","donor","donationYear","donorType","ajaxUrl","action","nonce","formData","FormData","append","isLoaded","response","fetch","method","body","responseText","ok","Error","status","jsonResponse","JSON","parse","success","tableData","destroyTableAsync","container","getElementById","elementId","innerHTML","tableId","event","destroyTable","clear","draw","destroy","Promise","resolve","updateContext","generateSkeletonTable","rows","rowIndex","colIndex","loadAnimation","querySelectorAll","length","skeletonTable","initLog","logTable","logState","key","console","log","logLoading"],"sourceRoot":""}