{"version":3,"file":"data-table/view.js","mappings":"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","sources":["webpack://data-tables/external module \"@wordpress/interactivity\"","webpack://data-tables/webpack/bootstrap","webpack://data-tables/webpack/runtime/make namespace object","webpack://data-tables/./src/data-table/view.js"],"sourcesContent":["module.exports = __WEBPACK_EXTERNAL_MODULE__wordpress_interactivity_8e89b257__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","/**\n * WordPress dependencies\n */\nimport { store, getContext, getElement, useState, useEffect } from '@wordpress/interactivity';\n\nlet initTable = ( el ) => {\n\tconst title = document.querySelector( '.site-main h1' )?.innerText || document.title;\n\treturn new DataTable( el, {\n\t\tinfo: false,\n\t\tpageLength: 50,\n\t\tlayout: {\n\t\t\tbottomEnd: {\n\t\t\t\tpaging: {\n\t\t\t\t\ttype: 'simple_numbers',\n\t\t\t\t},\n\t\t\t},\n\t\t\ttopEnd: {\n\t\t\t\tsearch: {\n\t\t\t\t\tplaceholder: 'Enter keyword...',\n\t\t\t\t\ttext: state.searchLabel,\n\t\t\t\t},\n\t\t\t},\n\t\t\ttopStart: {\n\t\t\t\tbuttons: [\n\t\t\t\t\t{\n\t\t\t\t\t\textend: 'csvHtml5',\n\t\t\t\t\t\ttitle: title,\n\t\t\t\t\t\ttext: 'Download Data',\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t}\n\t} );\n}\n\nconst skeletonTable = `\n    <table class=\"dataTable\">\n        <thead>\n            <tr>\n                <th>Loading...</th>\n                <th>Loading...</th>\n                <th>Loading...</th>\n                <th>Loading...</th>\n            </tr>\n        </thead>\n        <tbody>\n            <tr>\n                <td><div class=\"skeleton-box\"></div></td>\n                <td><div class=\"skeleton-box\"></div></td>\n                <td><div class=\"skeleton-box\"></div></td>\n                <td><div class=\"skeleton-box\"></div></td>\n            </tr>\n            <tr>\n                <td><div class=\"skeleton-box\"></div></td>\n                <td><div class=\"skeleton-box\"></div></td>\n                <td><div class=\"skeleton-box\"></div></td>\n                <td><div class=\"skeleton-box\"></div></td>\n            </tr>\n            <tr>\n                <td><div class=\"skeleton-box\"></div></td>\n                <td><div class=\"skeleton-box\"></div></td>\n                <td><div class=\"skeleton-box\"></div></td>\n                <td><div class=\"skeleton-box\"></div></td>\n            </tr>\n        </tbody>\n    </table>\n`;\n\nconst { state, actions, callbacks } = store( 'ttft/data-tables', {\n\tstate: {\n\t\tisLoading: false,\n        searchLabel: ''\n\t},\n    actions: {\n        async renderTable() {\n            const context = getContext();\n\n            try {\n                const { tableType, thinkTank, donor, donationYear, donorType, searchLabel, ajaxUrl, action, nonce } = state;\n\n                const formData = new FormData();\n                formData.append( 'action', action );\n                formData.append( 'nonce', nonce );\n                formData.append( 'table_type', tableType );\n                formData.append( 'search_label', searchLabel || 'Enter keyword...' );\n                formData.append( 'donation_year', donationYear || 'all' );\n                formData.append( 'donor_type', donorType || 'all' );\n                formData.append( 'think_tank', thinkTank );\n                formData.append( 'donor', donor );\n\n                callbacks.logFormData( formData );\n\n\t\t\t\tstate.isLoading = true;\n                context.isLoaded = false;\n\n                const response = await fetch( ajaxUrl, {\n                    method: 'POST',\n                    body: formData,\n                });\n\n                const responseText = await response.text();\n\n                callbacks.logResponseData( responseText );\n\n\t\t\t\tif ( ! response.ok ) {\n                    throw new Error( `HTTP error! status: ${response.status}` );\n                }\n\n                const jsonResponse = JSON.parse( responseText );\n\n                if ( jsonResponse.success ) {\n                    state.tableData = jsonResponse.data;\n\n                    await actions.destroyTableAsync();\n\n                    const container = document.getElementById( state.elementId );\n\n                    if ( container ) {\n                        container.innerHTML = jsonResponse.data;\n\n                        if ( state.table ) {\n                            state.table = initTable( `#${state.tableId}` );\n                        }\n                    }\n\n                } else {\n                    console.error( `Error fetching table data:`, jsonResponse.data );\n                }\n            } catch ( event ) {\n                console.error( `catch( event ) renderTable:`, event );\n            } finally {\n                state.isLoading = false;\n                context.isLoaded = true;\n            }\n        },\n\t\tinitTable: () => {\n\t\t\tstate.table = initTable( `#${state.tableId}`, state );\n\t\t},\n\t\tdestroyTable: () => {\n\t\t\tstate.table.clear().draw();\n\t\t\tstate.table.destroy();\n\t\t},\n        destroyTableAsync: () => {\n            return new Promise( ( resolve ) => {\n                actions.destroyTable();\n                resolve();\n            });\n        },\n        updateContext: () => {\n            const context = getContext();\n            context.tableType = state.tableType;\n            context.donationYear = state.donationYear;\n            context.donorType = state.donorType;\n        }\n    },\n    callbacks: {\n        loadAnimation: () => {\n            useEffect( () => { \n                const container = document.getElementById( state.elementId ); \n                if ( state.isLoading ) { \n                    container.innerHTML = skeletonTable; \n                } }, [ state.isLoading ] );\n        },\n        initLog: () => {\n            console.log( `Initial State: `, JSON.stringify( state, undefined, 2 )  );\n            const { tableType, donationYear, donorType, isLoaded } = getContext();\n            console.log( `Initial Context: ${tableType}, isLoaded: ${isLoaded}, ${donationYear}, ${donorType}` );\n        },\n        logTable: () => {\n            const { tableType, thinkTank, donor, donationYear, donorType, isLoading } = state;\n            console.log( `State: `, tableType, thinkTank, donor, donationYear, donorType, isLoading );\n        },\n        logFormData: ( data ) => {\n            for ( const [ key, value ] of data.entries() ) {\n                console.log( `${ key }: ${ value }` );\n            }\n        },\n        logState: ( key ) => {\n            console.log( `key: `, state.key );\n        },\n        logResponseData: ( data ) => {\n            // console.log( 'Raw response:', data );\n        },\n\t\tlogLoading: () => {\n\t\t\tconsole.log( `IS LOADING: `, state.isLoading );\n\t\t},\n        log: ( message, data ) => {\n            console.log( message, data );\n        },\n        logError: ( message, error ) => {\n            console.error( message, error );\n        }\n    },\n});\n"],"names":["store","getContext","getElement","useState","useEffect","initTable","el","title","document","querySelector","innerText","DataTable","info","pageLength","layout","bottomEnd","paging","type","topEnd","search","placeholder","text","state","searchLabel","topStart","buttons","extend","skeletonTable","actions","callbacks","isLoading","renderTable","context","tableType","thinkTank","donor","donationYear","donorType","ajaxUrl","action","nonce","formData","FormData","append","logFormData","isLoaded","response","fetch","method","body","responseText","logResponseData","ok","Error","status","jsonResponse","JSON","parse","success","tableData","data","destroyTableAsync","container","getElementById","elementId","innerHTML","table","tableId","console","error","event","destroyTable","clear","draw","destroy","Promise","resolve","updateContext","loadAnimation","initLog","log","stringify","undefined","logTable","key","value","entries","logState","logLoading","message","logError"],"sourceRoot":""}