import*as e from"@wordpress/interactivity";var t={d:(e,a)=>{for(var n in a)t.o(a,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:a[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const a=(c={getContext:()=>e.getContext,store:()=>e.store,useEffect:()=>e.useEffect,useState:()=>e.useState},s={},t.d(s,c),s),n=e=>{const t=document.querySelector(".site-main h1")?.innerText||document.title;let a=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"});const{tableType:n,thinkTank:r,donor:l,donationYear:c,donorType:s,search:d,searchLabel:i,ajaxUrl:p,action:b,nonce:u,pageLength:y}=o;return new DataTable(e,{retrieve:!0,api:!0,autoWidth:!1,processing:!0,layout:{topEnd:{search:{placeholder:"Enter keyword...",text:o.searchLabel||"Search",processing:!0,menu:[25,50,75,100]}},topStart:{buttons:[{extend:"csvHtml5",title:t,text:"Download Data",exportOptions:{columns:":visible:not(.noExport)"}}],info:{callback:function(e,t,a,n,o,r){return`${n} Records Found`}}},bottomStart:!1,bottomEnd:{paging:{type:"simple_numbers"}}},render:{currency:function(e,t,n){return a.format(e)},number:function(e,t,a){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,"'")}},drawCallback:function(e){},initComplete:function(e,t){},headerCallback:function(e,t,a,n,o){},footerCallback:function(e,t,a,n,o){}})},{state:o,actions:r,callbacks:l}=(0,a.store)("ttft/data-tables",{state:{isLoading:!1,donationYear:"all",donorType:"all",entityType:"think_tank"},actions:{async renderTable(){const e=(0,a.getContext)();try{const{tableType:t,thinkTank:a,donor:r,donationYear:l,donorType:c,search:s,searchLabel:d,ajaxUrl:i,action:p,nonce:b}=o,u=new FormData;u.append("action",p),u.append("nonce",b),u.append("table_type",t),u.append("search_label",d||"Search"),u.append("donation_year",l||"all"),u.append("donor_type",c||"all"),u.append("think_tank",a),u.append("donor",r),u.append("search",s||""),o.isLoading=!0,e.isLoaded=!1;const y=await fetch(i,{method:"POST",body:u}),h=await y.text();if(!y.ok)throw new Error(`HTTP error! status: ${y.status}`);const f=JSON.parse(h);if(f.success){o.tableData=f.data;const e=document.getElementById(o.elementId);e&&(e.innerHTML=f.data,o.table&&(o.table.clear(),o.table=n(`#${o.tableId}`)))}else console.error("Error fetching table data:",f.data)}catch(e){console.error("catch( event ) renderTable:",e)}finally{o.isLoading=!1,e.isLoaded=!0}},initTable:()=>{o.table=n(`#${o.tableId}`)},destroyTable:()=>{o.table.clear().draw(),o.table.destroy()},destroyTableAsync:()=>new Promise((e=>{r.destroyTable(),e()})),setContext:()=>{const e=(0,a.getContext)();e.searchLabel&&(e.searchLabel=o.searchLabel)},generateSkeletonTable:e=>{let t="";for(let a=0;a<10;a++){t+='<tr class="row skeleton-row" width="100%">';for(let a=0;a<e;a++)t+='<td class="cell skeleton-cell"><div class="loader"></div></td>';t+="</tr>"}return t}},callbacks:{renderTable:()=>{const e=(()=>{const[e,t]=(0,a.useState)(o.donorType),[n,r]=(0,a.useState)(o.donationYear),l=()=>e!==o.donorType||n!==o.donationYear;return(0,a.useEffect)((()=>{l()&&(t(o.donorType),r(o.donationYear))}),[o.donorType,o.donationYear]),l()})();(0,a.useEffect)((()=>{e&&r.renderTable()}))},loadAnimation:()=>{(0,a.useEffect)((()=>{const e=document.getElementById(o.elementId);if(o.isLoading&&e){const t=e.querySelectorAll("thead th").length,a=r.generateSkeletonTable(t),n=e.querySelector("tbody");n&&(n.innerHTML=a)}}),[o.isLoading])}}});var c,s;